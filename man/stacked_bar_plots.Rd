% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seurat_utils.R
\name{stacked_bar_plots}
\alias{stacked_bar_plots}
\title{Plot Cluster Distribution Across Metadata Layers}
\usage{
stacked_bar_plots(
  object,
  idents,
  layers,
  layer_orders = list(),
  colors,
  percentage_by = NULL,
  title = NULL,
  show_counts = FALSE,
  count_size = 3,
  count_color = "black",
  count_vjust = -0.5,
  .color_map = NULL
)
}
\arguments{
\item{object}{A Seurat object. containing metadata columns specified in \code{idents}
and \code{layers}.}

\item{idents}{A string specifying the metadata column that contains cluster assignments.}

\item{layers}{A character vector (length 1â€“3) specifying one or more metadata columns
to group by when plotting. If three layers are provided, plots will be generated
for each level of the third layer.}

\item{layer_orders}{An optional named list specifying the custom order of values
for each metadata layer. The names must match entries in \code{layers}.}

\item{colors}{A vector of colors used to fill clusters in the plot.}

\item{percentage_by}{Optional character vector specifying the metadata column(s)
by which percentages should be normalized. Defaults to \code{layers}.}

\item{title}{Optional plot title.}

\item{show_counts}{Logical indicating whether to display total cell counts on top of each bar.
Default is FALSE.}

\item{count_size}{Numeric value for the size of count labels. Default is 3.}

\item{count_color}{Color for count labels. Default is "black".}

\item{count_vjust}{Vertical adjustment for count labels. Default is -0.5 (above bar).}

\item{.color_map}{Internal parameter for passing fixed color mapping in recursive calls.}
}
\value{
\itemize{
\item If \code{length(layers) <= 2}: A \code{ggplot} object showing cluster proportions.
\item If \code{length(layers) == 3}: A named list of \code{ggplot} objects, one for each
level of the third layer. The list has an attribute \code{"layer_order"} corresponding
to the order of those levels.
}
}
\description{
This function visualizes the distribution of Seurat clusters across one or more
metadata layers (e.g., sample, condition, or treatment). It supports one, two,
or three hierarchical layers. When three layers are provided, the function
generates a list of plots (one per level of the third layer).
}
\details{
The function calculates the percentage of cells per cluster within the specified
grouping layers. When three layers are provided, it subsets the Seurat object by
each level of the third layer and recursively generates plots using the first two
layers.
}
\examples{
\dontrun{
# Example: plot cluster distribution by sample and condition
stacked_bar_plots(
  object = seurat_obj,
  idents = "seurat_clusters",
  layers = c("sample", "condition"),
  layer_orders = list(
    sample = c("S1", "S2", "S3"),
    condition = c("Control", "Treatment")
  ),
  colors = RColorBrewer::brewer.pal(8, "Set2"),
  title = "Cluster distribution across samples",
  show_counts = TRUE
)
}

}
