% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/customized_vis.R
\name{heatmap_meta}
\alias{heatmap_meta}
\title{Generate Cell-Type-Level Expression Heatmap}
\usage{
heatmap_meta(
  object,
  features,
  groups,
  idents = NULL,
  bold_genes = NULL,
  row_fontsize = 10,
  normalize = TRUE,
  cluster_rows = FALSE,
  cluster_cols = FALSE,
  scale = "row",
  title = NA,
  angle_col = "315",
  file_name = NULL,
  ...
)
}
\arguments{
\item{object}{A Seurat object containing expression data and metadata}

\item{features}{Character vector of gene names to include in the heatmap}

\item{groups}{Character vector specifying the order of cell type/group labels.
This defines both which groups to include and their display order.}

\item{idents}{Character string specifying the metadata column containing
cell type or group information. If NULL, defaults to "cohort_tp".}

\item{bold_genes}{Character vector of gene names to render in \strong{bold} text.
Uses \code{bquote(bold(...))} for formatting. Default is NULL (no bolding).}

\item{row_fontsize}{Numeric value specifying the font size for row labels (gene names).
Default is 10.}

\item{normalize}{Logical indicating whether to normalize the data before plotting.
Default is TRUE.}

\item{cluster_rows}{Logical indicating whether to cluster rows (genes).
Default is FALSE.}

\item{cluster_cols}{Logical indicating whether to cluster columns (groups).
Default is FALSE.}

\item{scale}{Character string indicating scaling method. Options are "row" (default),
"column", or "none".}

\item{title}{Optional character string for plot title. Default is NA (no title).}

\item{angle_col}{Character string or numeric specifying the angle for column labels.
Default is "315".}

\item{file_name}{name of png file.}

\item{...}{Additional arguments passed to pheatmap::pheatmap()}
}
\value{
A pheatmap object
}
\description{
This function creates a heatmap showing gene expression averaged across cell types
or groups. Expression values are aggregated by taking the mean across all cells
within each group, then optionally row-scaled (z-score normalized) for visualization.
It allows for customization of gene label appearance.
}
\details{
The function performs the following steps:
\enumerate{
\item Optionally normalizes the Seurat object
\item Extracts expression data for specified genes
\item Averages expression across all cells within each group
\item Orders groups according to the specified order
\item Creates a heatmap with row scaling (z-score by default), applying bolding
to specified gene names via \code{labels_row} and setting global font size via
\code{fontsize_row}.
}

Row scaling computes z-scores as: $z = (x - mean(x)) / sd(x)$
where x represents expression values across all groups for a given gene.
}
\examples{
\dontrun{
# Basic usage with bolded genes and larger font size
heatmap_meta(
object = object,
features = c("CD3D", "CD8A", "IFNG", "FOXP3"),
groups = c("CD4 T", "CD8 T", "NK"),
bold_genes = c("CD8A", "FOXP3"),
row_fontsize = 12
)

# With custom group column and no normalization
heatmap_meta(
object = object,
features = marker_genes,
groups = c("Chronic Pre-DAA", "ACTG Pre-DAA", "SR Pre-resolution"),
idents = "condition",
normalize = FALSE
)
}

}
