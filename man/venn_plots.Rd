% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/customized_vis.R
\name{venn_plots}
\alias{venn_plots}
\title{Create Venn Diagram from Differential Expression Comparisons}
\usage{
venn_plots(
  object,
  comparisons,
  idents,
  direction = "up",
  log2fc_threshold = 0.58,
  min_pct = 0.3,
  p_adj_cutoff = 0.05,
  fills = NULL,
  alpha = 0.6,
  main = NULL,
  subtitle = NULL,
  label_cex = 1.2,
  quantity_cex = 1,
  file_name = "eulerr_plot",
  ...
)
}
\arguments{
\item{object}{A Seurat object containing expression data and metadata}

\item{comparisons}{Named list where names are comparison labels
(e.g., "Group A vs Group B") and values are character vectors of length 2
specifying which groups to compare (e.g., c("Group A", "Group B")).
Must contain between 3 and 6 comparisons.}

\item{idents}{Character string specifying the metadata column containing
group identities. This column will be set as the active identity.}

\item{direction}{Character string specifying which genes to include in the Venn.
Options are "up" (upregulated in ident.1), "down" (downregulated in ident.1),
or "both". Default is "up".}

\item{log2fc_threshold}{Numeric value specifying the minimum absolute log2
fold change threshold for significance. Default is 0.58.}

\item{min_pct}{Numeric value specifying the minimum fraction of cells expressing
the gene in either group. Default is 0.3.}

\item{p_adj_cutoff}{Numeric value for adjusted p-value cutoff. Default is 0.05.}

\item{fills}{Character vector of colors for the Venn diagram circles. If NULL,
a default palette will be used. Length should match the number of comparisons.}

\item{alpha}{Numeric value between 0 and 1 for transparency of circles.
Default is 0.6.}

\item{main}{Character string for the main title. If NULL, a default title
will be generated. Default is NULL.}

\item{subtitle}{Character string for subtitle. If NULL, parameters will be
shown. Default is NULL.}

\item{label_cex}{Numeric value for label text size. Default is 1.2.}

\item{quantity_cex}{Numeric value for quantity text size. Default is 1.0.}

\item{file_name}{Output png file name. Default is eulerr_plot.}

\item{...}{Additional arguments passed to eulerr::euler()}
}
\value{
A list containing:
\describe{
\item{markers}{A named list of data frames, one per comparison, containing
full differential expression results from FindMarkers}
\item{genes}{A named list of character vectors containing the filtered gene
names that passed the thresholds for each comparison}
\item{euler_fit}{The fitted euler object}
\item{plot}{The plot is drawn directly; returns invisible}
}
}
\description{
This function performs multiple pairwise differential expression comparisons
between groups and visualizes the overlap of significantly differentially
expressed genes using an area-proportional Venn/Euler diagram.
}
\details{
The function performs the following steps:
\enumerate{
\item Sets the specified metadata column as active identity
\item Performs pairwise differential expression using Seurat::FindMarkers
\item Filters genes based on p_adj, log2FC, and direction criteria
\item Creates an area-proportional Venn/Euler diagram showing overlaps
}

For "up" direction, genes are filtered where avg_log2FC > log2fc_threshold.
For "down" direction, genes are filtered where avg_log2FC < -log2fc_threshold.
For "both" direction, genes are filtered where |avg_log2FC| > log2fc_threshold.
}
\examples{
\dontrun{
# Custom comparisons with named list
comparisons <- list(
  "Chronic vs ACTG" = c("Chronic Post-DAA Conserved", "ACTG Post-DAA Conserved"),
  "Chronic vs SR" = c("Chronic Post-DAA Conserved", "SR ≥24W-post-resolution unknown"),
  "ACTG vs SR" = c("ACTG Post-DAA Conserved", "SR ≥24W-post-resolution unknown")
)

result <- venn_plots(
  object = object,
  comparisons = comparisons,
  idents = "Cohort_tp_mutation",
  log2fc_threshold = 0.58,
  min_pct = 0.3,
  main = "Upregulated Genes"
)

# Look at downregulated genes
comparisons <- list(
  "A vs B" = c("Group1", "Group2"),
  "A vs C" = c("Group1", "Group3"),
  "B vs C" = c("Group2", "Group3")
)

venn_plots(
  object = object,
  comparisons = comparisons,
  idents = "treatment",
  direction = "down",
  log2fc_threshold = 0.5
)

# Access results
result$markers  # Full marker data frames
result$genes    # Filtered gene lists
}

}
