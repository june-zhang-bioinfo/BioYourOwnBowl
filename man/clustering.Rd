% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seurat_utils.R
\name{clustering}
\alias{clustering}
\title{Automated parameter sweep for Seurat clustering}
\usage{
clustering(
  object,
  reduction = "pca",
  k_range,
  resolution_range,
  dims,
  clusters_min = 5,
  clusters_max = 8,
  colors = NULL,
  output_file = "dimplot.pdf"
)
}
\arguments{
\item{object}{A Seurat object.}

\item{reduction}{dimensional reduction to be used. Default is "pca".}

\item{k_range}{Numeric vector specifying the range of \code{k.param} values to test
in \code{FindNeighbors()}.}

\item{resolution_range}{Numeric vector specifying the range of resolution values
to test in \code{FindClusters()}.}

\item{dims}{Integer vector of principal components to use in neighbor finding.}

\item{clusters_min}{Minimum acceptable number of clusters for a valid result.
Defaults to a user-specified value.}

\item{clusters_max}{Maximum acceptable number of clusters for a valid result.
Defaults to a user-specified value.}

\item{colors}{Optional vector of colors for clusters in plots.}

\item{output_file}{PDF file name to save all DimPlots. Default: "dimplot.pdf".}
}
\value{
A Seurat object with additional metadata columns for each valid clustering.
A PDF file (\file{dimplot.pdf}) containing all \code{DimPlot}s is also saved.
}
\description{
This function performs iterative clustering across a range of neighbor
parameters (\code{k.param}) and resolution values. For each valid clustering result
(based on the number of clusters), it generates a \code{DimPlot} annotated with
cluster counts and saves all plots to a PDF file.
}
\details{
For each combination of \code{k.param} and \code{resolution}, the function runs:
\enumerate{
\item \code{FindNeighbors(object, dims = dims, k.param = k)}
\item \code{FindClusters(object, resolution = r)}
}
It then checks if the resulting number of clusters is between
\code{clusters_min} and \code{clusters_max}. If so, a \code{DimPlot} is created with
labeled clusters and saved to a combined PDF file named \file{dimplot.pdf}.

Each accepted clustering is also stored in the Seurat object metadata
under a column named \code{"k<k>_r<r>"} (e.g., \code{"k20_r0.8"}).
}
\examples{
\dontrun{
seurat_obj <- clustering(
  object = seurat_obj,
  k_range = 10:30,
  resolution_range = seq(0.2, 1.2, by = 0.2),
  dims = 1:20,
  clusters_min = 5,
  clusters_max = 20
)
}

}
