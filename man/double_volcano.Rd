% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/customized_vis.R
\name{double_volcano}
\alias{double_volcano}
\title{Generate 2D Log2 Fold-Change Comparison Plots Between Identity Pairs}
\usage{
double_volcano(
  object,
  comparison_table,
  output_dir = "2dim_log2fc",
  lfc_threshold = log2(1.5),
  pval_cutoff = 0.05,
  min.pct = 0,
  color_palette = NULL,
  selected_genes = NULL
)
}
\arguments{
\item{object}{A \code{Seurat} object containing expression and metadata.}

\item{comparison_table}{A data frame specifying pairs of identities to compare.
Each row should include four columns (e.g., \code{ident1}, \code{ident2},
\code{ident3}, \code{ident4}) defining two comparisons.}

\item{output_dir}{Character. Path to the directory where plots will be saved.
Defaults to \code{"2dim_log2fc"}.}

\item{lfc_threshold}{Numeric. Log2 fold-change threshold used for coloring.
Default is \code{log2(1.5)}.}

\item{pval_cutoff}{Numeric. Adjusted p-value cutoff for significance. Default is 0.05.}

\item{min.pct}{Numeric. min.pvt cutoff for FindMarkers. Default is 0.}

\item{color_palette}{Named character vector of colors to use for each group.
If NULL, a default palette will be used.}

\item{selected_genes}{Optional character vector of genes to label on the plots.}
}
\value{
Invisibly returns a list of file paths to the saved plots.
}
\description{
This function performs pairwise differential expression analysis between
specified identity groups in a Seurat object, merges results from two
comparisons, classifies genes by directionality and significance, and
visualizes the results as 2D scatter plots of \eqn{log2FC_1} vs. \eqn{log2FC_2}.
}
\details{
For each row in \code{comparison_table}, the function:
\enumerate{
\item Runs \code{FindMarkers()} twice â€” once for (\code{ident1} vs. \code{ident2})
and once for (\code{ident3} vs. \code{ident4}).
\item Merges results by gene.
\item Assigns each gene to a color group based on the direction and significance
of both comparisons.
\item Plots \code{avg_log2FC_1} vs. \code{avg_log2FC_2} with color-coded points,
significance thresholds, and labeled selected genes.
\item Saves the resulting plot as a PNG file.
}
}
\examples{
\dontrun{
df <- read.csv("2dim_log2fc.csv")
user_palette <- c(
  "Brown" = "saddlebrown", "Blue" = "dodgerblue", "LightBlue" = "skyblue",
  "Green" = "darkgreen", "Purple" = "purple", "Orange" = "orange",
  "Pink" = "pink", "LightGreen" = "lightgreen"
)

double_volcano(object, df, output_dir = "2dim_log2fc",
               lfc_threshold = log2(2), pval_cutoff = 0.01,
               color_palette = user_palette,
               selected_genes = c("CD8A", "PDCD1"))
}
}
