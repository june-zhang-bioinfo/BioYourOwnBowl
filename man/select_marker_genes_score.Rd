% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seurat_utils.R
\name{select_marker_genes_score}
\alias{select_marker_genes_score}
\title{Select marker genes based on product score}
\usage{
select_marker_genes_score(
  markers,
  top_n = 25,
  direction = "up",
  adj_p_cutoff = 0.05,
  log2fc_cutoff = 0
)
}
\arguments{
\item{markers}{A data frame or tibble containing marker gene statistics.
Must include the following columns:
\describe{
\item{gene}{Gene name or identifier.}
\item{cluster}{Cluster or group label.}
\item{p_val_adj}{Adjusted p-value (typically from a Seurat differential expression test).}
\item{avg_log2FC}{Average log2 fold change between the cluster and others.}
}}

\item{top_n}{Integer specifying the number of top marker genes to select per cluster,
ranked by score. Default is 25.}

\item{direction}{Character string specifying whether to select upregulated
(\code{"up"}) or downregulated (\code{"down"}) genes. Default is \code{"up"}.}

\item{adj_p_cutoff}{Numeric value specifying the statistical significance cutoff.}

\item{log2fc_cutoff}{Numeric value specifying the minimum absolute log2 fold change
threshold. Default is 0.}
}
\value{
A tibble containing the selected genes with columns:
\describe{
\item{gene}{Gene name.}
\item{cluster}{Cluster identifier.}
\item{p_val_adj}{Adjusted p-value.}
\item{avg_log2FC}{Average log2 fold change.}
\item{score}{Computed score for ranking.}
}
}
\description{
This function selects marker genes from a differential expression results table
using a scoring system that combines statistical significance (\code{p_val_adj}) and
effect size (\code{avg_log2FC}). It can take results from both \code{FindAllMarkers} (> 2 groups) and \code{FindMarkers} (2 groups).
}
\details{
If using results from \code{FindMarkers}, \code{direction} doesn't take effect. Please make sure you add \code{cluster} column indicating the group name in the input.

The function computes a composite score for each gene as:
\deqn{score = -log10(p\_val\_adj) * |avg\_log2FC|}

It then filters genes based on the specified direction (\code{avg_log2FC > log2fc_cutoff} for \code{"up"},
\code{avg_log2FC < -log2fc_cutoff} for \code{"down"}), selects the top \code{n} genes by score per cluster. If \code{p_val_adj} is zero, it is replaced with
the smallest positive representable value to avoid infinite scores.
}
\examples{
\dontrun{
markers <- FindAllMarkers(seurat_object)
selected_genes <- c("CD3D", "MS4A1", "LYZ")

# Select top 20 upregulated genes with log2FC > 0.5
selected <- select_marker_genes_score(
  markers,
  top_n = 20,
  direction = "up",
  log2fc_cutoff = 0.5
)
head(selected)
}

}
