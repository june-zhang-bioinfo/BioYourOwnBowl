% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/customized_vis.R
\name{volcano_plots}
\alias{volcano_plots}
\title{Create Volcano Plot from Differential Expression Analysis}
\usage{
volcano_plots(
  object,
  idents,
  ident1,
  ident2,
  show_labels = FALSE,
  log2fc_cutoff = 1,
  p_cutoff = 0.01,
  file_name = NULL,
  title = NULL,
  width = 2000,
  height = 2000,
  resolution = 300,
  point_size = 1,
  label_size = 2,
  boxed_labels = TRUE,
  draw_connectors = TRUE,
  max_overlaps = 50
)
}
\arguments{
\item{object}{A Seurat object containing expression data and metadata}

\item{idents}{Character string specifying the metadata column containing
group identities. This column will be set as the active identity.}

\item{ident1}{Character string specifying the first identity group (numerator
in the comparison, typically the "test" group).}

\item{ident2}{Character string specifying the second identity group (denominator
in the comparison, typically the "control" group).}

\item{show_labels}{Can be one of three options:
\itemize{
\item FALSE (default): No gene labels are shown
\item TRUE: All gene labels are shown
\item Character vector: Only specified genes are labeled
}}

\item{log2fc_cutoff}{Numeric value for log2 fold change threshold to highlight
significant genes. Default is 1.}

\item{p_cutoff}{Numeric value for adjusted p-value cutoff to highlight significant
genes. Default is 0.01.}

\item{file_name}{Optional character string for output file prefix. If provided,
plots will be saved as PNG files. If NULL, plots are displayed but not saved.
Default is NULL.}

\item{title}{Optional character string for plot title. If NULL, no title is shown.
Default is NULL.}

\item{width}{Numeric value for plot width in pixels when saving. Default is 2000.}

\item{height}{Numeric value for plot height in pixels when saving. Default is 2000.}

\item{resolution}{Numeric value for plot resolution (DPI) when saving. Default is 300.}

\item{point_size}{Numeric value for point size in the volcano plot. Default is 1.}

\item{label_size}{Numeric value for gene label text size. Default is 2.}

\item{boxed_labels}{Logical indicating whether to draw boxes around gene labels.
Default is TRUE.}

\item{draw_connectors}{Logical indicating whether to draw connectors from points
to labels. Default is TRUE.}

\item{max_overlaps}{Integer specifying maximum number of overlapping labels allowed.
Default is 50.}
}
\value{
A list containing:
\describe{
\item{markers}{Data frame with differential expression results from FindMarkers}
\item{n1}{Number of cells in ident1}
\item{n2}{Number of cells in ident2}
\item{deg_up}{Number of upregulated genes (log2FC > cutoff, p.adj < cutoff)}
\item{deg_down}{Number of downregulated genes (log2FC < -cutoff, p.adj < cutoff)}
}
}
\description{
This function performs differential expression analysis between two groups
and creates volcano plots with optional gene labeling using EnhancedVolcano.
}
\details{
The function performs the following steps:
\enumerate{
\item Counts cells in each group
\item Performs differential expression using Seurat::FindMarkers
\item Replaces p-values of 0 with machine epsilon to avoid plotting issues
\item Creates volcano plot(s) with EnhancedVolcano
\item Optionally saves plot(s) as PNG files
}
}
\examples{
\dontrun{
# No labels (default)
result <- plot_volcano_de(
  object = seurat_obj,
  idents = "cell_type",
  ident1 = "CD8 T",
  ident2 = "CD4 T"
)

# Show all labels
result <- plot_volcano_de(
  object = seurat_obj,
  idents = "treatment",
  ident1 = "Treated",
  ident2 = "Control",
  show_labels = TRUE
)

# Show specific genes only
selected <- c("GNLY", "GZMB", "PRF1", "CCL4")
result <- plot_volcano_de(
  object = seurat_obj,
  idents = "Timepoint disease stage",
  ident1 = "FC",
  ident2 = "Acute HBV resolved",
  show_labels = selected,
  log2fc_cutoff = 1,
  p_cutoff = 0.01,
  file_name = "volcano/FC_vs_Acute",
  title = "CD8 T cells"
)
}

}
